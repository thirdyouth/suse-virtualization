*******************************************
第二章：KVM 的限制
*******************************************

尽管虚拟机和物理机器表现非常相似，但仍然存在诸多限制。它们同时对 VM 客户机和 VM 主机产生影响。

常规限制
===========================================

在使用 KVM 时，存在下面常规的条件限制：

* **超载**

  KVM 同时允许内存和硬盘空间超载。对这种问题产生的影响，将有用户来进行处理。然而，由可用资源的超负荷使用产生的严重错误将会导致客户机失败出错。尽管 CPU 的超载也是支持的，但是将会带来性能问题。
  
* **时间同步**

  多数客户机对准确的时间同步需要一些额外的支持。尽管有可用的 kvm-clock 能够使用。仍然推荐使用 NTP 或者类似的基于网络的时间同步协议（对于 VM 主机服务器和 VM 客户机）来保持稳定的时间。在使用 kvm-clock 时，不推荐在客户机中使用 NTP 。更多信息可以参考 `时钟设置`_ 。
  
* **MAC 地址**

  如果没有为 NIC 指定 MAC 地址，将会使用默认的 MAC 地址。在多于一个 NIC 接收同一个 MAC 地址时可能会产生网络问题。推荐总是为每一个 NIC 赋予一个唯一的 MAC 地址。
  
* **在线迁移**

  在线迁移只有在具有同样 CPU 功能的 VM 主机服务器之间才可以进行。而且唯一支持迁移的 CPU 模块是没有其他附加功能特性的 -cpu qemu64 （默认）。不可以将主机中的物理设备移交给客户机。客户机的存储必须同时可以被 VM 主机和客户机访问，并且必须兼容。VM 主机和 VM 客户机需要有时间同步机制。AHCI 接口使用，virtfs 功能，以及 -mem-path 命令行参数和迁移不兼容。从 SP3 向 SP2 和 SP1 托管的客户机的迁移是不被支持的。
  
* **用户权限**

  管理工具需要使用 libvirt 进行认证，详情参考 `第六章：连接和认证`_ 。如果希望在命令行中调用 qemu-kvm ，用户必须加入 kvm 用户组。
  
* **VM 主机挂起和休眠**

  在客户机运行时，不支持 VM 主机系统的挂起和休眠。


硬件限制
===========================================

对客户机而言，经过测试，存在下面的虚拟硬件限制。我们确定主机和客户机都正常安装和工作，即便已经达到了这些限制条件，并且并不存在重大的性能问题（CPU，内存， 硬盘和网络）。

==========================   ===============================================================================

==========================   =============================================================================== 
最大客户机内存                  512GB
最大单客户机虚拟CPU数量           64
最大单客户机网络设备数            8
最大单客户机块设备               4个模拟IDE，20个para-virtual（使用 virtio-blk），或者100 （virtio-scsi）
最大单主机托管虚拟机数量          所有客户机的虚拟 CPU 数量不得超过主机所具有核心数的 8 倍
==========================   ===============================================================================  

性能限制
===========================================
